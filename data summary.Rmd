---
title: "Data Summaries"
author: "Eric Huang"
date: "3/2/2019"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data
```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(ggplot2)
library(tidyr)
library(lubridate)
library(reshape2)
library(naniar)
library(gridExtra)
library(plyr)
```

```{r}
rsNet1718 <- read.csv("~/Desktop/thesisDocuments/totalNet1718.csv")
vacancies1718 <- read.csv("~/Desktop/thesisDocuments/vacancies1718.csv")
occupancy1819 <- read.csv("~/Desktop/thesisDocuments/occupancy1819.csv")
surveyResults <- read.csv("~/Desktop/thesisDocuments/rsSurvey18.csv")

```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
occupancy1819 <- occupancy1819[,-c(19)]
surveyResults <- surveyResults[,-c(14,15)]

# change variable names
rsNet1718Names <- c("Dates", "CLY", "DOH", "FAX", "HEN", "HIGH", "MMA", "MCG", "MG", 
                 "NEV", "RES", "ROSE", "SHA", "SP", "WEB", "WEL", "WW", "WOOD", 
                 "netParticipation")
names(rsNet1718) = rsNet1718Names

vacancies1718Names <- c("Dates", "CLY", "DOH", "FAX", "HEN", "HIGH", "MMA", "MCG", "MG", 
                   "NEV", "RES", "ROSE", "SHA", "SP", "WEB", "WEL", "WW", "WOOD", 
                   "totalVacancies")
names(vacancies1718) = vacancies1718Names

occupancy1819Names <- c("Dates", "CLY", "DOH", "FAX", "HEN", "HIGH", "MMA", "MCG", "MG", 
                        "NEV", "RES", "ROSE", "SHA", "SP", "WEB", "WEL", "WW", "WOOD", 
                        "totalParticipation")
names(occupancy1819) = occupancy1819Names

# subsetting Room Selection timeframe

# 2017 dates
# Retentions/Pullins: 2/26-2/28
# Block Housing: 3/1-3/3
# General Selection: 3/5 and onwards

# rsNet1718
rsNet1718ByHouses <- rsNet1718[1:32,1:18]
rsNet1718Total <- rsNet1718[1:32,c(1,19)]
rsNet1718ByHousesApr <- rsNet1718[1:18,1:18]
rsNet1718ByHousesRetention <- rsNet1718[1:2,1:18]
rsNet1718ByHousesBlock <- rsNet1718[3:5,1:18]
rsNet1718ByHousesGeneral <- rsNet1718[6:15,1:18]
rsNet1718ByHousesOpen <- rsNet1718[16:18,1:18]
rsNet1718TotalApr <- rsNet1718[1:18,c(1,19)]

# vacancies1718
vacancies1718ByHouses <- vacancies1718[1:40,1:18]
vacancies1718Total <- vacancies1718[1:40,c(1,19)]
vacancies1718ByHousesApr <- vacancies1718[1:19,1:18]
vacancies1718ByHousesRetention <- vacancies1718[1:2,1:18]
vacancies1718ByHousesBlock <- vacancies1718[3:5,1:18]
vacancies1718ByHousesGeneral <- vacancies1718[6:15,1:18]
vacancies1718ByHousesOpen <- vacancies1718[16:18,1:18]
vacancies1718TotalApr <- vacancies1718[1:19,c(1,19)]

# 2018 dates
# Retentions/Pullins: 2/26-2/28
# Block Housing: 3/1-3/3
# General Selection: 3/5 and onwards

# occupancy1819
occupancy1819ByHouses <- occupancy1819[1:15,1:18]
occupancy1819ByHousesRetention <- occupancy1819[1:3,1:18]
occupancy1819ByHousesBlock <- occupancy1819[4:5,1:18]
occupancy1819ByHousesGeneral <- occupancy1819[6:12,1:18]
occupancy1819ByHousesOpen <- occupancy1819[13:18,1:18]
occupancy1819Total <- occupancy1819[1:15,c(1,19)]
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
# tidying data: converting wide- to long-form data
newRSNet1718ByHouses <- reshape2::melt(rsNet1718ByHouses, 
                                       value.name = "Participation", 
                                       varnames = c("Date", "Houses"))

newRSNet1718ByHousesApr <- reshape2::melt(rsNet1718ByHousesApr, 
                                       value.name = "Participation", 
                                       varnames = c("Date", "Houses"))

newRSNet1718ByHousesRetention <- reshape2::melt(rsNet1718ByHousesRetention, 
                                       value.name = "Participation", 
                                       varnames = c("Date", "Houses"))

newRSNet1718ByHousesBlock <- reshape2::melt(rsNet1718ByHousesBlock, 
                                       value.name = "Participation", 
                                       varnames = c("Date", "Houses"))

newRSNet1718ByHousesGeneral <- reshape2::melt(rsNet1718ByHousesGeneral, 
                                       value.name = "Participation", 
                                       varnames = c("Date", "Houses"))

newRSNet1718ByHousesOpen <- reshape2::melt(rsNet1718ByHousesOpen, 
                                       value.name = "Participation", 
                                       varnames = c("Date", "Houses"))

newVacancies1718ByHouses <- reshape2::melt(vacancies1718ByHouses, value.name = "Vacancies",
                            varnames = c("Date", "Houses"))

newVacancies1718ByHousesApr <- reshape2::melt(vacancies1718ByHousesApr, value.name = "Vacancies",
                                           varnames = c("Date", "Houses"))

newVacancies1718ByHousesRetention <- reshape2::melt(vacancies1718ByHousesRetention, value.name = "Vacancies",
                                           varnames = c("Date", "Houses"))

newVacancies1718ByHousesBlock <- reshape2::melt(vacancies1718ByHousesBlock, value.name = "Vacancies",
                                           varnames = c("Date", "Houses"))

newVacancies1718ByHousesGeneral <- reshape2::melt(vacancies1718ByHousesGeneral, value.name = "Vacancies",
                                           varnames = c("Date", "Houses"))

newVacancies1718ByHousesOpen <- reshape2::melt(vacancies1718ByHousesOpen, value.name = "Vacancies",
                                           varnames = c("Date", "Houses"))

newOccupancyByHouses <- reshape2::melt(occupancy1819ByHouses, 
                                       value.name = "Participation", 
                                       varnames = c("Date", "Houses"))

newOccupancyByHousesRetention <- reshape2::melt(occupancy1819ByHousesRetention, 
                                       value.name = "Participation", 
                                       varnames = c("Date", "Houses"))

newOccupancyByHousesBlock <- reshape2::melt(occupancy1819ByHousesBlock, 
                                       value.name = "Participation", 
                                       varnames = c("Date", "Houses"))

newOccupancyByHousesGeneral <- reshape2::melt(occupancy1819ByHousesGeneral, 
                                       value.name = "Participation", 
                                       varnames = c("Date", "Houses"))

newOccupancyByHousesOpen <- reshape2::melt(occupancy1819ByHousesOpen, 
                                       value.name = "Participation", 
                                       varnames = c("Date", "Houses"))
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Fixing dates

# rsNet1718
newRSNet1718ByHousesDates = as.character(as.Date(newRSNet1718ByHouses$Dates, 
                                                 format = "%m/%d/%Y"))
substr(newRSNet1718ByHousesDates, 1, 2) = "20"
newRSNet1718ByHouses$Dates = as.Date(newRSNet1718ByHousesDates)

rsNet1718TotalDates = as.character(as.Date(rsNet1718Total$Dates, 
                                           format = "%m/%d/%Y"))
substr(rsNet1718TotalDates, 1, 2) = "20"
rsNet1718Total$Dates = as.Date(rsNet1718TotalDates)

newRSNet1718ByHousesAprDates = as.character(as.Date(newRSNet1718ByHousesApr$Dates, 
                                                    format = "%m/%d/%Y"))
substr(newRSNet1718ByHousesAprDates, 1, 2) = "20"
newRSNet1718ByHousesApr$Dates = as.Date(newRSNet1718ByHousesAprDates)

newRSNet1718ByHousesRetentionDates = as.character(as.Date(newRSNet1718ByHousesRetention$Dates, 
                                                    format = "%m/%d/%Y"))
substr(newRSNet1718ByHousesRetentionDates, 1, 2) = "20"
newRSNet1718ByHousesRetention$Dates = as.Date(newRSNet1718ByHousesRetentionDates)

newRSNet1718ByHousesBlockDates = as.character(as.Date(newRSNet1718ByHousesBlock$Dates, 
                                                    format = "%m/%d/%Y"))
substr(newRSNet1718ByHousesBlockDates, 1, 2) = "20"
newRSNet1718ByHousesBlock$Dates = as.Date(newRSNet1718ByHousesBlockDates)

newRSNet1718ByHousesGeneralDates = as.character(as.Date(newRSNet1718ByHousesGeneral$Dates, 
                                                    format = "%m/%d/%Y"))
substr(newRSNet1718ByHousesGeneralDates, 1, 2) = "20"
newRSNet1718ByHousesGeneral$Dates = as.Date(newRSNet1718ByHousesGeneralDates)

newRSNet1718ByHousesOpenDates = as.character(as.Date(newRSNet1718ByHousesOpen$Dates, 
                                                    format = "%m/%d/%Y"))
substr(newRSNet1718ByHousesOpenDates, 1, 2) = "20"
newRSNet1718ByHousesOpen$Dates = as.Date(newRSNet1718ByHousesOpenDates)

rsNet1718TotalAprDates = as.character(as.Date(rsNet1718TotalApr$Dates, 
                                              format = "%m/%d/%Y"))
substr(rsNet1718TotalAprDates, 1, 2) = "20"
rsNet1718TotalApr$Dates = as.Date(rsNet1718TotalAprDates)

# vacancies1718
newVacancies1718ByHousesDates = as.character(as.Date(newVacancies1718ByHouses$Dates, 
                                                     format = "%m/%d/%Y"))
substr(newVacancies1718ByHousesDates, 1, 2) = "20"
newVacancies1718ByHouses$Dates = as.Date(newVacancies1718ByHousesDates)

vacancies1718TotalDates = as.character(as.Date(vacancies1718Total$Dates, 
                                               format = "%m/%d/%Y"))
substr(vacancies1718TotalDates, 1, 2) = "20"
vacancies1718Total$Dates = as.Date(vacancies1718TotalDates)

newVacancies1718ByHousesAprDates = as.character(as.Date(newVacancies1718ByHousesApr$Dates, format = "%m/%d/%Y"))
substr(newVacancies1718ByHousesAprDates, 1, 2) = "20"
newVacancies1718ByHousesApr$Dates = as.Date(newVacancies1718ByHousesAprDates)

newVacancies1718ByHousesRetentionDates = as.character(as.Date(newVacancies1718ByHousesRetention$Dates, format = "%m/%d/%Y"))
substr(newVacancies1718ByHousesRetentionDates, 1, 2) = "20"
newVacancies1718ByHousesRetention$Dates = as.Date(newVacancies1718ByHousesRetentionDates)

newVacancies1718ByHousesBlockDates = as.character(as.Date(newVacancies1718ByHousesBlock$Dates, format = "%m/%d/%Y"))
substr(newVacancies1718ByHousesBlockDates, 1, 2) = "20"
newVacancies1718ByHousesBlock$Dates = as.Date(newVacancies1718ByHousesBlockDates)

newVacancies1718ByHousesGeneralDates = as.character(as.Date(newVacancies1718ByHousesGeneral$Dates, format = "%m/%d/%Y"))
substr(newVacancies1718ByHousesGeneralDates, 1, 2) = "20"
newVacancies1718ByHousesGeneral$Dates = as.Date(newVacancies1718ByHousesGeneralDates)

newVacancies1718ByHousesOpenDates = as.character(as.Date(newVacancies1718ByHousesOpen$Dates, format = "%m/%d/%Y"))
substr(newVacancies1718ByHousesOpenDates, 1, 2) = "20"
newVacancies1718ByHousesOpen$Dates = as.Date(newVacancies1718ByHousesOpenDates)

vacancies1718TotalAprDates = as.character(as.Date(vacancies1718TotalApr$Dates, 
                                                  format = "%m/%d/%Y"))
substr(vacancies1718TotalAprDates, 1, 2) = "20"
vacancies1718TotalApr$Dates = as.Date(vacancies1718TotalAprDates)

# occupancy1819
newOccupancyByHousesDates = as.character(as.Date(newOccupancyByHouses$Dates, 
                                                 format = "%m/%d/%Y"))
substr(newOccupancyByHousesDates, 1, 2) = "20"
newOccupancyByHouses$Dates = as.Date(newOccupancyByHousesDates)

newOccupancyByHousesRetentionDates = as.character(as.Date(newOccupancyByHousesRetention$Dates, 
                                                 format = "%m/%d/%Y"))
substr(newOccupancyByHousesRetentionDates, 1, 2) = "20"
newOccupancyByHousesRetention$Dates = as.Date(newOccupancyByHousesRetentionDates)

newOccupancyByHousesBlockDates = as.character(as.Date(newOccupancyByHousesBlock$Dates, 
                                                 format = "%m/%d/%Y"))
substr(newOccupancyByHousesBlockDates, 1, 2) = "20"
newOccupancyByHousesBlock$Dates = as.Date(newOccupancyByHousesBlockDates)

newOccupancyByHousesGeneralDates = as.character(as.Date(newOccupancyByHousesGeneral$Dates, 
                                                 format = "%m/%d/%Y"))
substr(newOccupancyByHousesGeneralDates, 1, 2) = "20"
newOccupancyByHousesGeneral$Dates = as.Date(newOccupancyByHousesGeneralDates)

newOccupancyByHousesOpenDates = as.character(as.Date(newOccupancyByHousesOpen$Dates, 
                                                 format = "%m/%d/%Y"))
substr(newOccupancyByHousesOpenDates, 1, 2) = "20"
newOccupancyByHousesOpen$Dates = as.Date(newOccupancyByHousesOpenDates)

occupancy1819TotalDates = as.character(as.Date(occupancy1819Total$Dates, 
                                               format = "%m/%d/%Y"))
substr(occupancy1819TotalDates, 1, 2) = "20"
occupancy1819Total$Dates = as.Date(occupancy1819TotalDates)
```

## Exploratory Graphs
#### 2017-18 Room Selection Participation
```{r}
# rsNet1718 by Houses through June 
ggplot(newRSNet1718ByHouses,aes(x = Dates, y = Participation, group = variable, 
                                colour = variable)) +
  geom_line()

# rsNet1718 total participation through June
ggplot(rsNet1718Total,aes(x = Dates, y = netParticipation)) + 
  geom_line()

# rsNet1718 by Houses through April
ggplot(newRSNet1718ByHousesApr,aes(x = Dates, y = Participation, group = variable, 
                                   colour = variable)) +
  geom_line() +
  labs(fill = "Houses")

# rsNet1718 by Houses during Retention
ggplot(newRSNet1718ByHousesRetention,aes(x = Dates, y = Participation, 
                                                    group = variable, 
                                                    colour = variable)) +
                  geom_line() +
                  labs(fill = "Houses")

# rsNet1718 by Houses during Block Housing
ggplot(newRSNet1718ByHousesBlock,aes(x = Dates, y = Participation, 
                                               group = variable, 
                                               colour = variable)) +
                geom_line() +
                labs(fill = "Houses")

# rsNet1718 by Houses during General Selection
ggplot(newRSNet1718ByHousesGeneral,aes(x = Dates, y = Participation, 
                                                   group = variable, 
                                                   colour = variable)) +
                    geom_line() +
                    labs(fill = "Houses")

# rsNet1718 by Houses during Open Assignment
ggplot(newRSNet1718ByHousesOpen,aes(x = Dates, y = Participation, 
                                             group = variable, 
                                             colour = variable)) +
                geom_line() +
                labs(fill = "Houses")

# rsNet1718 total participation through April
ggplot(rsNet1718TotalApr,aes(x = Dates, y = netParticipation)) + 
  geom_line()

# bar charts of counts
ggplot(newRSNet1718ByHousesRetention,aes(x = variable, y = Participation)) +
                  geom_bar(stat = "identity") +
                  labs(title = "Retention by houses", fill = "Houses")

ggplot(newRSNet1718ByHousesBlock,aes(x = variable, y = Participation)) +
                  geom_bar(stat = "identity") +
                  labs(title = "Block Housing by houses", fill = "Houses")

ggplot(newRSNet1718ByHousesGeneral,aes(x = variable, y = Participation)) +
                  geom_bar(stat = "identity") +
                  labs(title = "General Selection by houses", fill = "Houses")

ggplot(newRSNet1718ByHousesOpen,aes(x = variable, y = Participation)) +
                  geom_bar(stat = "identity") +
                  labs(title = "Open Assignment by houses", fill = "Houses")
```

#### 2017-18 Vacancies
```{r}
# vacancies1718 by Houses until start of Fall opening
ggplot(newVacancies1718ByHouses,aes(x = Dates, y = Vacancies, group = variable, 
                                    colour = variable)) +
  geom_line()

# vacancies1718 total participation until start of Fall opening
ggplot(vacancies1718Total,aes(x = Dates, y = totalVacancies)) + 
  geom_line()

# vacancies1718 by Houses through April
ggplot(newVacancies1718ByHousesApr,aes(x = Dates, y = Vacancies, group = variable, 
                                       colour = variable)) +
  geom_line()

# vacancies1718 by Houses during Retention
ggplot(newVacancies1718ByHousesRetention,aes(x = Dates, y = Vacancies, group = variable, 
                                       colour = variable)) +
  geom_line()

# vacancies1718 by Houses during Block Housing
ggplot(newVacancies1718ByHousesBlock,aes(x = Dates, y = Vacancies, group = variable, 
                                       colour = variable)) +
  geom_line()

# vacancies1718 by Houses during General Selection
ggplot(newVacancies1718ByHousesGeneral,aes(x = Dates, y = Vacancies, group = variable, 
                                       colour = variable)) +
  geom_line()

# vacancies1718 by Houses during Open Assignment
ggplot(newVacancies1718ByHousesOpen,aes(x = Dates, y = Vacancies, group = variable, 
                                       colour = variable)) +
  geom_line()

# vacancies1718 total participation through April
ggplot(vacancies1718TotalApr,aes(x = Dates, y = totalVacancies)) + 
  geom_line()

# bar chart of counts
r <- ggplot(newVacancies1718ByHousesRetention,aes(x = variable, y = Vacancies)) +
                  geom_bar(stat = "identity", position = "identity") +
                  labs(title = "Retention by houses", fill = "Houses")

b <- ggplot(newVacancies1718ByHousesBlock,aes(x = variable, y = Vacancies)) +
                  geom_bar(stat = "identity", position = "identity") +
                  labs(title = "Block Housing by houses", fill = "Houses")

g <- ggplot(newVacancies1718ByHousesGeneral,aes(x = variable, y = Vacancies)) +
                  geom_bar(stat = "identity", position = "identity") +
                  labs(title = "General Selection by houses", fill = "Houses")

o <- ggplot(newVacancies1718ByHousesOpen,aes(x = variable, y = Vacancies)) +
                  geom_bar(stat = "identity", position = "identity") +
                  labs(title = "Open Assignment by houses", fill = "Houses")

grid.arrange(r,b,g,o,ncol=2)
```

#### 2018-19 Room Selection
```{r}
# occupancy1819 by Houses
ggplot(newOccupancyByHouses,aes(x = Dates, y = Participation, group = variable, 
                                colour = variable)) + 
  geom_line()

# occupancy1819 by Houses during Retention
ggplot(newOccupancyByHousesRetention,aes(x = Dates, y = Participation, group = variable, 
                                colour = variable)) + 
  geom_line()

# occupancy1819 by Houses during Block
ggplot(newOccupancyByHousesBlock,aes(x = Dates, y = Participation, group = variable, 
                                colour = variable)) + 
  geom_line()

# occupancy1819 by Houses during General Selection
ggplot(newOccupancyByHousesGeneral,aes(x = Dates, y = Participation, group = variable, 
                                colour = variable)) + 
  geom_line()

# occupancy1819 by Houses during Open Assignment
ggplot(newOccupancyByHousesOpen,aes(x = Dates, y = Participation, group = variable, 
                                colour = variable)) + 
  geom_line()

# occupancy1819 total participation
ggplot(occupancy1819Total,aes(x = Dates, y = totalParticipation)) + 
  geom_line()
```

#### 2017-18 Room Selection
```{r, echo=FALSE, warning=FALSE, message=FALSE}
# rsNet1718ByHousesApr_copy <- rsNet1718ByHousesApr
# rs1718_copy_copy <- rsNet1718ByHousesApr_copy
# 
# rs1718_copy_copy$Dates = as.Date(as.character(rs1718_copy_copy$Dates), "%m/%d/%y")
# rs1718_copy_copy$Month = as.numeric(format(rs1718_copy_copy$Dates, format = "%m"))
# rs1718_copy_copy$Day = as.numeric(format(rs1718_copy_copy$Dates, format = "%d"))
# rs1718_copy_copy$Group = with(rs1718_copy_copy,
#                                   ifelse(Month == 2, "Retention",
#                                          ifelse((Month == 3) & (Day == 1 | Day == 2),
#                                                 "Block", "General")))
# rs1718_copy_copy$Month = NULL; rs1718_copy_copy$Day = NULL;
# rs1718_copy_copy$Dates = NULL;
# # plyr::ddply(rs1718_copy_copy, .(Group), function(x) colSums(x[,-18]))
# 
# phasesByHouses <- rs1718_copy_copy[,c(1:17,23)]
# phasesByNeighborhood <- rs1718_copy_copy[,c(18:20,23)]
# phasesByBuilding <- rs1718_copy_copy[,c(21:23)]
# 
# newPhasesByHouses <- reshape2::melt(phasesByHouses,
#                                        value.name = "Participation",
#                                        varnames = c("Phase", "Houses"))
# 
# newPhasesByNeighborhood <- reshape2::melt(phasesByNeighborhood,
#                                        value.name = "Participation",
#                                        varnames = c("Phase", "Houses"))
# 
# newPhasesByBuilding <- reshape2::melt(phasesByBuilding,
#                                        value.name = "Participation",
#                                        varnames = c("Phase", "Houses"))
```

```{r}
# # phases by houses
# ggplot(data = newPhasesByHouses, aes(x = newPhasesByHouses$Group,
#                                       fill = newPhasesByHouses$variable,
#                                       na.rm = TRUE)) + 
#       geom_bar(aes(y = newPhasesByHouses$Participation), stat = "identity") +
#       labs(x = "Phase", y = "Count", fill = "House")
# 
# # phases by neighborhood
# ggplot(data = newPhasesByNeighborhood, aes(x = newPhasesByNeighborhood$Group,
#                                       fill = newPhasesByNeighborhood$variable,
#                                       na.rm = TRUE)) + 
#       geom_bar(aes(y = newPhasesByNeighborhood$Participation), stat = "identity") +
#       labs(x = "Phase", y = "Count", fill = "House")
# 
# # phases by building/room types
# ggplot(data = newPhasesByBuilding, aes(x = newPhasesByBuilding$Group,
#                                       fill = newPhasesByBuilding$variable,
#                                       na.rm = TRUE)) + 
#       geom_bar(aes(y = newPhasesByBuilding$Participation), stat = "identity") +
#       labs(x = "Phase", y = "Count", fill = "House")
```

#### 2017-18 Vacancies
```{r}
################################################################################
```

#### 2018-19 Room Selection
```{r}
################################################################################
```

### By Neighborhood
+ Hill: HEN, MMA, MCG, RES, ROSE, SP, WEL, WW, WOOD
+ Morewood: DOH, MG
+ Oakland: CLY, FAX, HIGH, NEV, SHA, WEB

#### 2017-18 Room Selection
```{r, echo=FALSE, warning=FALSE, message=FALSE}
rsNet1718ByHousesApr_copy <- rsNet1718ByHousesApr

# create new columns of aggregated data by neighborhood
rsNet1718ByHousesApr_copy$Hill <- rsNet1718ByHousesApr_copy$HEN +
                                  rsNet1718ByHousesApr_copy$MMA +
                                  rsNet1718ByHousesApr_copy$MCG +
                                  rsNet1718ByHousesApr_copy$RES +
                                  rsNet1718ByHousesApr_copy$ROSE +
                                  rsNet1718ByHousesApr_copy$SP +
                                  rsNet1718ByHousesApr_copy$WEL +
                                  rsNet1718ByHousesApr_copy$WW +
                                  rsNet1718ByHousesApr_copy$WOOD
rsNet1718ByHousesApr_copy$Morewood <- rsNet1718ByHousesApr_copy$DOH +
                                      rsNet1718ByHousesApr_copy$MG
rsNet1718ByHousesApr_copy$Oakland <-rsNet1718ByHousesApr_copy$CLY +
                                    rsNet1718ByHousesApr_copy$FAX +
                                    rsNet1718ByHousesApr_copy$HIGH +
                                    rsNet1718ByHousesApr_copy$NEV +
                                    rsNet1718ByHousesApr_copy$SHA +
                                    rsNet1718ByHousesApr_copy$WEB

# rsNet1718 by neighborhoods
rsNet1718AprNeighborhoods <- rsNet1718ByHousesApr_copy[,-c(2:18)]
rsNet1718AprNeighborhoodsRetention <- rsNet1718AprNeighborhoods[1:2,]
rsNet1718AprNeighborhoodsBlock <- rsNet1718AprNeighborhoods[3:5,]
rsNet1718AprNeighborhoodsGeneral <- rsNet1718AprNeighborhoods[6:15,]
rsNet1718AprNeighborhoodsOpen <- rsNet1718AprNeighborhoods[16:18,]

newRSNet1718AprNeighborhoods <- reshape2::melt(rsNet1718AprNeighborhoods, 
                                                value.name = "Participation", 
                                                varnames = c("Date", "Neighborhoods"))

newRSNet1718AprNeighborhoodsRetention <- reshape2::melt(rsNet1718AprNeighborhoodsRetention, 
                                                value.name = "Participation", 
                                                varnames = c("Date", "Neighborhoods"))

newRSNet1718AprNeighborhoodsBlock <- reshape2::melt(rsNet1718AprNeighborhoodsBlock, 
                                                value.name = "Participation", 
                                                varnames = c("Date", "Neighborhoods"))

newRSNet1718AprNeighborhoodsGeneral <- reshape2::melt(rsNet1718AprNeighborhoodsGeneral, 
                                                value.name = "Participation", 
                                                varnames = c("Date", "Neighborhoods"))

newRSNet1718AprNeighborhoodsOpen <- reshape2::melt(rsNet1718AprNeighborhoodsOpen, 
                                                value.name = "Participation", 
                                                varnames = c("Date", "Neighborhoods"))

newRSNet1718AprNeighborhoodsDates = as.character(as.Date(newRSNet1718AprNeighborhoods$Dates, 
                                                         format = "%m/%d/%Y"))
substr(newRSNet1718AprNeighborhoodsDates, 1, 2) = "20"
newRSNet1718AprNeighborhoods$Dates = as.Date(newRSNet1718AprNeighborhoodsDates)

newRSNet1718AprNeighborhoodsRetentionDates = as.character(as.Date(newRSNet1718AprNeighborhoodsRetention$Dates, 
                                                         format = "%m/%d/%Y"))
substr(newRSNet1718AprNeighborhoodsRetentionDates, 1, 2) = "20"
newRSNet1718AprNeighborhoodsRetention$Dates = as.Date(newRSNet1718AprNeighborhoodsRetentionDates)

newRSNet1718AprNeighborhoodsBlockDates = as.character(as.Date(newRSNet1718AprNeighborhoodsBlock$Dates, 
                                                         format = "%m/%d/%Y"))
substr(newRSNet1718AprNeighborhoodsBlockDates, 1, 2) = "20"
newRSNet1718AprNeighborhoodsBlock$Dates = as.Date(newRSNet1718AprNeighborhoodsBlockDates)

newRSNet1718AprNeighborhoodsGeneralDates = as.character(as.Date(newRSNet1718AprNeighborhoodsGeneral$Dates, 
                                                         format = "%m/%d/%Y"))
substr(newRSNet1718AprNeighborhoodsGeneralDates, 1, 2) = "20"
newRSNet1718AprNeighborhoodsGeneral$Dates = as.Date(newRSNet1718AprNeighborhoodsGeneralDates)

newRSNet1718AprNeighborhoodsOpenDates = as.character(as.Date(newRSNet1718AprNeighborhoodsOpen$Dates, 
                                                         format = "%m/%d/%Y"))
substr(newRSNet1718AprNeighborhoodsOpenDates, 1, 2) = "20"
newRSNet1718AprNeighborhoodsOpen$Dates = as.Date(newRSNet1718AprNeighborhoodsOpenDates)

# Descriptive Stats
colSums(rsNet1718AprNeighborhoods[,-1])
colSums(rsNet1718AprNeighborhoodsRetention[,-1])
colSums(rsNet1718AprNeighborhoodsBlock[,-1])
colSums(rsNet1718AprNeighborhoodsGeneral[,-1])
colSums(rsNet1718AprNeighborhoodsOpen[,-1])
```

```{r}
# rsNet1718 by Neighborhoods
ggplot(newRSNet1718AprNeighborhoods,aes(x = Dates, y = Participation, 
                                        group = variable, colour = variable)) + 
  geom_line()

# rsNet1718 by Neighborhoods during Retention
retain1 <- ggplot(newRSNet1718AprNeighborhoodsRetention,aes(x = Dates, y = Participation, 
                                        group = variable, colour = variable)) + 
  geom_line() +
  theme(legend.position="none")

# rsNet1718 by Neighborhoods during Block
block1 <- ggplot(newRSNet1718AprNeighborhoodsBlock,aes(x = Dates, y = Participation, 
                                        group = variable, colour = variable)) + 
  geom_line() +
  theme(legend.position="none")

# rsNet1718 by Neighborhoods during General Selection
general1 <- ggplot(newRSNet1718AprNeighborhoodsGeneral,aes(x = Dates, y = Participation, 
                                        group = variable, colour = variable)) + 
  geom_line() +
  theme(legend.position="none")

# rsNet1718 by Neighborhoods during Open Assignment
open1 <- ggplot(newRSNet1718AprNeighborhoodsOpen,aes(x = Dates, y = Participation, 
                                        group = variable, colour = variable)) + 
  geom_line()

grid.arrange(retain1, block1, general1, open1, ncol = 2)
```

#### 2017-18 Vacancies
```{r, echo=FALSE, warning=FALSE, message=FALSE}
vacancies1718ByHousesApr_copy <- vacancies1718ByHousesApr

# create new columns of aggregated data by neighborhood
vacancies1718ByHousesApr_copy$Hill <- vacancies1718ByHousesApr_copy$HEN +
                                      vacancies1718ByHousesApr_copy$MMA +
                                      vacancies1718ByHousesApr_copy$MCG +
                                      vacancies1718ByHousesApr_copy$RES +
                                      vacancies1718ByHousesApr_copy$ROSE +
                                      vacancies1718ByHousesApr_copy$SP +
                                      vacancies1718ByHousesApr_copy$WEL +
                                      vacancies1718ByHousesApr_copy$WW +
                                      vacancies1718ByHousesApr_copy$WOOD
vacancies1718ByHousesApr_copy$Morewood <- vacancies1718ByHousesApr_copy$DOH +
                                          vacancies1718ByHousesApr_copy$MG
vacancies1718ByHousesApr_copy$Oakland <-vacancies1718ByHousesApr_copy$CLY +
                                        vacancies1718ByHousesApr_copy$FAX +
                                        vacancies1718ByHousesApr_copy$HIGH +
                                        vacancies1718ByHousesApr_copy$NEV +
                                        vacancies1718ByHousesApr_copy$SHA +
                                        vacancies1718ByHousesApr_copy$WEB
# vacancies1718 by neighborhoods
vacancies1718AprNeighborhoods <- vacancies1718ByHousesApr_copy[,-c(2:18)]
vacancies1718AprNeighborhoodsRetention <- vacancies1718AprNeighborhoods[1:2,]
vacancies1718AprNeighborhoodsBlock <- vacancies1718AprNeighborhoods[3:5,]
vacancies1718AprNeighborhoodsGeneral <- vacancies1718AprNeighborhoods[6:15,]
vacancies1718AprNeighborhoodsOpen <- vacancies1718AprNeighborhoods[16:18,]

newVacancies1718AprNeighborhoods <- reshape2::melt(vacancies1718AprNeighborhoods, 
                                               value.name = "Participation", 
                                               varnames = c("Date", "Neighborhoods"))

newVacancies1718AprNeighborhoodsRetention <- reshape2::melt(vacancies1718AprNeighborhoodsRetention, 
                                               value.name = "Participation", 
                                               varnames = c("Date", "Neighborhoods"))

newVacancies1718AprNeighborhoodsBlock <- reshape2::melt(vacancies1718AprNeighborhoodsBlock, 
                                               value.name = "Participation", 
                                               varnames = c("Date", "Neighborhoods"))

newVacancies1718AprNeighborhoodsGeneral <- reshape2::melt(vacancies1718AprNeighborhoodsGeneral, 
                                               value.name = "Participation", 
                                               varnames = c("Date", "Neighborhoods"))

newVacancies1718AprNeighborhoodsOpen <- reshape2::melt(vacancies1718AprNeighborhoodsOpen, 
                                               value.name = "Participation", 
                                               varnames = c("Date", "Neighborhoods"))

newVacancies1718AprNeighborhoodsDates = as.character(as.Date(newVacancies1718AprNeighborhoods$Dates, format = "%m/%d/%Y"))
substr(newVacancies1718AprNeighborhoodsDates, 1, 2) = "20"
newVacancies1718AprNeighborhoods$Dates = as.Date(newVacancies1718AprNeighborhoodsDates)

newVacancies1718AprNeighborhoodsRetentionDates = as.character(as.Date(newVacancies1718AprNeighborhoodsRetention$Dates, format = "%m/%d/%Y"))
substr(newVacancies1718AprNeighborhoodsRetentionDates, 1, 2) = "20"
newVacancies1718AprNeighborhoodsRetention$Dates = as.Date(newVacancies1718AprNeighborhoodsRetentionDates)

newVacancies1718AprNeighborhoodsBlockDates = as.character(as.Date(newVacancies1718AprNeighborhoodsBlock$Dates, format = "%m/%d/%Y"))
substr(newVacancies1718AprNeighborhoodsBlockDates, 1, 2) = "20"
newVacancies1718AprNeighborhoodsBlock$Dates = as.Date(newVacancies1718AprNeighborhoodsBlockDates)

newVacancies1718AprNeighborhoodsGeneralDates = as.character(as.Date(newVacancies1718AprNeighborhoodsGeneral$Dates, format = "%m/%d/%Y"))
substr(newVacancies1718AprNeighborhoodsGeneralDates, 1, 2) = "20"
newVacancies1718AprNeighborhoodsGeneral$Dates = as.Date(newVacancies1718AprNeighborhoodsGeneralDates)

newVacancies1718AprNeighborhoodsOpenDates = as.character(as.Date(newVacancies1718AprNeighborhoodsOpen$Dates, format = "%m/%d/%Y"))
substr(newVacancies1718AprNeighborhoodsOpenDates, 1, 2) = "20"
newVacancies1718AprNeighborhoodsOpen$Dates = as.Date(newVacancies1718AprNeighborhoodsOpenDates)

```

```{r}
# vacancies1718 by neighborhood
ggplot(newVacancies1718AprNeighborhoods,aes(x = Dates, y = Participation, 
                                            group = variable, colour = variable)) + 
  geom_line()

# vacancies1718 by neighborhood during Retention
retain2 <- ggplot(newVacancies1718AprNeighborhoodsRetention,aes(x = Dates, 
                                                                y = Participation, 
                                                                group = variable, 
                                                                colour = variable)) + 
                  geom_line() +
                  theme(legend.position="none")

# vacancies1718 by neighborhood during Block
block2 <- ggplot(newVacancies1718AprNeighborhoodsBlock,aes(x = Dates, y = Participation, 
                                            group = variable, colour = variable)) + 
                  geom_line() +
                  theme(legend.position="none")

# vacancies1718 by neighborhood during General Selection
general2 <- ggplot(newVacancies1718AprNeighborhoodsGeneral,aes(x = Dates, 
                                                               y = Participation, 
                                                               group = variable, 
                                                               colour = variable)) + 
                    geom_line() +
                    theme(legend.position="none")

# vacancies1718 by neighborhood during Open Assignment
open2 <- ggplot(newVacancies1718AprNeighborhoodsOpen,aes(x = Dates, y = Participation, 
                                            group = variable, colour = variable)) + 
                geom_line()

grid.arrange(retain2, block2, general2, open2)
```

#### 2018-19 Room Selection
```{r, echo=FALSE, warning=FALSE, message=FALSE}
occupancy1819ByHouses_copy <- occupancy1819ByHouses

# create new columns of aggregated data by neighborhood
occupancy1819ByHouses_copy$Hill <-occupancy1819ByHouses_copy$HEN +
                                  occupancy1819ByHouses_copy$MMA +
                                  occupancy1819ByHouses_copy$MCG +
                                  occupancy1819ByHouses_copy$RES +
                                  occupancy1819ByHouses_copy$ROSE +
                                  occupancy1819ByHouses_copy$SP +
                                  occupancy1819ByHouses_copy$WEL +
                                  occupancy1819ByHouses_copy$WW +
                                  occupancy1819ByHouses_copy$WOOD
occupancy1819ByHouses_copy$Morewood <-occupancy1819ByHouses_copy$DOH +
                                      occupancy1819ByHouses_copy$MG
occupancy1819ByHouses_copy$Oakland <- occupancy1819ByHouses_copy$CLY +
                                      occupancy1819ByHouses_copy$FAX +
                                      occupancy1819ByHouses_copy$HIGH +
                                      occupancy1819ByHouses_copy$NEV +
                                      occupancy1819ByHouses_copy$SHA +
                                      occupancy1819ByHouses_copy$WEB
# occupancy1819 by neighborhoods
occupancy1819Neighborhoods <- occupancy1819ByHouses_copy[,-c(2:18)]
occupancy1819NeighborhoodsRetention <- occupancy1819Neighborhoods[1:3,]
occupancy1819NeighborhoodsBlock <- occupancy1819Neighborhoods[4:5,]
occupancy1819NeighborhoodsGeneral <- occupancy1819Neighborhoods[6:12,]
occupancy1819NeighborhoodsOpen <- occupancy1819Neighborhoods[13:15,]

newOccupancy1819Neighborhoods <- reshape2::melt(occupancy1819Neighborhoods, 
                                                value.name = "Participation", 
                                                varnames = c("Date", "Neighborhoods"))

newOccupancy1819NeighborhoodsRetention <- reshape2::melt(occupancy1819NeighborhoodsRetention, 
                                                value.name = "Participation", 
                                                varnames = c("Date", "Neighborhoods"))

newOccupancy1819NeighborhoodsBlock <- reshape2::melt(occupancy1819NeighborhoodsBlock, 
                                                value.name = "Participation", 
                                                varnames = c("Date", "Neighborhoods"))

newOccupancy1819NeighborhoodsGeneral <- reshape2::melt(occupancy1819NeighborhoodsGeneral, 
                                                value.name = "Participation", 
                                                varnames = c("Date", "Neighborhoods"))

newOccupancy1819NeighborhoodsOpen <- reshape2::melt(occupancy1819NeighborhoodsOpen, 
                                                value.name = "Participation", 
                                                varnames = c("Date", "Neighborhoods"))

newOccupancy1819NeighborhoodsDates = as.character(as.Date(newOccupancy1819Neighborhoods$Dates, 
                                                          format = "%m/%d/%Y"))
substr(newOccupancy1819NeighborhoodsDates, 1, 2) = "20"
newOccupancy1819Neighborhoods$Dates = as.Date(newOccupancy1819NeighborhoodsDates)

newOccupancy1819NeighborhoodsRetentionDates = as.character(as.Date(newOccupancy1819NeighborhoodsRetention$Dates, 
                                                          format = "%m/%d/%Y"))
substr(newOccupancy1819NeighborhoodsRetentionDates, 1, 2) = "20"
newOccupancy1819NeighborhoodsRetention$Dates = as.Date(newOccupancy1819NeighborhoodsRetentionDates)

newOccupancy1819NeighborhoodsBlockDates = as.character(as.Date(newOccupancy1819NeighborhoodsBlock$Dates, 
                                                          format = "%m/%d/%Y"))
substr(newOccupancy1819NeighborhoodsBlockDates, 1, 2) = "20"
newOccupancy1819NeighborhoodsBlock$Dates = as.Date(newOccupancy1819NeighborhoodsBlockDates)

newOccupancy1819NeighborhoodsGeneralDates = as.character(as.Date(newOccupancy1819NeighborhoodsGeneral$Dates, 
                                                          format = "%m/%d/%Y"))
substr(newOccupancy1819NeighborhoodsGeneralDates, 1, 2) = "20"
newOccupancy1819NeighborhoodsGeneral$Dates = as.Date(newOccupancy1819NeighborhoodsGeneralDates)

newOccupancy1819NeighborhoodsOpenDates = as.character(as.Date(newOccupancy1819NeighborhoodsOpen$Dates, 
                                                          format = "%m/%d/%Y"))
substr(newOccupancy1819NeighborhoodsOpenDates, 1, 2) = "20"
newOccupancy1819NeighborhoodsOpen$Dates = as.Date(newOccupancy1819NeighborhoodsOpenDates)
```

```{r}
# Descriptive Stats
colSums(occupancy1819Neighborhoods[,-1])
colSums(occupancy1819NeighborhoodsRetention[,-1])
colSums(occupancy1819NeighborhoodsBlock[,-1])
colSums(occupancy1819NeighborhoodsGeneral[,-1])
colSums(occupancy1819NeighborhoodsOpen[,-1])

```

```{r}
# occupancy1819 by neighborhood
ggplot(newOccupancy1819Neighborhoods,aes(x = Dates, y = Participation, 
                                         group = variable, colour = variable)) + 
  geom_line()

# occupancy1819 by neighborhood during Retention
retain3 <- ggplot(newOccupancy1819NeighborhoodsRetention,aes(x = Dates, y = Participation, 
                                         group = variable, colour = variable)) + 
  geom_line() +
  theme(legend.position="none")

# occupancy1819 by neighborhood during Block
block3 <- ggplot(newOccupancy1819NeighborhoodsBlock,aes(x = Dates, y = Participation, 
                                         group = variable, colour = variable)) + 
  geom_line() +
  theme(legend.position="none")

# occupancy1819 by neighborhood during General Selection
general3 <- ggplot(newOccupancy1819NeighborhoodsGeneral,aes(x = Dates, y = Participation, 
                                         group = variable, colour = variable)) + 
  geom_line() +
  theme(legend.position="none")

# occupancy1819 by neighborhood during Open Assignment
open3 <- ggplot(newOccupancy1819NeighborhoodsOpen,aes(x = Dates, y = Participation, 
                                         group = variable, colour = variable)) + 
  geom_line()

grid.arrange(retain3, block3, general3, open3)
```

### By Building/Room Type
+ Apartment: CLY, DOH, FAX, HIGH, MMA, NEV, ROSE, SHA, SP, WEB, WOOD
+ Residence_Hall: HEN, MCG, MG, RES, WEL, WW

#### 2017-18 Room Selection
```{r, echo=FALSE, warning=FALSE, message=FALSE}
# create new columns of aggregated data by building/room type
rsNet1718ByHousesApr_copy$Apartment <-rsNet1718ByHousesApr_copy$DOH +
                                      rsNet1718ByHousesApr_copy$MMA +
                                      rsNet1718ByHousesApr_copy$CLY +
                                      rsNet1718ByHousesApr_copy$FAX +
                                      rsNet1718ByHousesApr_copy$HIGH +
                                      rsNet1718ByHousesApr_copy$NEV +
                                      rsNet1718ByHousesApr_copy$SHA +
                                      rsNet1718ByHousesApr_copy$WEB +
                                      rsNet1718ByHousesApr_copy$ROSE +
                                      rsNet1718ByHousesApr_copy$SP +
                                      rsNet1718ByHousesApr_copy$WOOD
rsNet1718ByHousesApr_copy$Residence_Hall <- rsNet1718ByHousesApr_copy$HEN +
                                            rsNet1718ByHousesApr_copy$MCG +
                                            rsNet1718ByHousesApr_copy$MG +
                                            rsNet1718ByHousesApr_copy$RES +
                                            rsNet1718ByHousesApr_copy$WEL +
                                            rsNet1718ByHousesApr_copy$WW
# rsNet1718 by building/room types
rsNet1718AprBuildings <- rsNet1718ByHousesApr_copy[,-c(2:21)]
rsNet1718AprBuildingsRetention <- rsNet1718AprBuildings[1:2,]
rsNet1718AprBuildingsBlock <- rsNet1718AprBuildings[3:5,]
rsNet1718AprBuildingsGeneral <- rsNet1718AprBuildings[6:15,]
rsNet1718AprBuildingsOpen <- rsNet1718AprBuildings[16:18,]

newRSNet1718AprBuildings <- reshape2::melt(rsNet1718AprBuildings, 
                                            value.name = "Participation", 
                                            varnames = c("Date", "Buildings"))

newRSNet1718AprBuildingsRetention <- reshape2::melt(rsNet1718AprBuildingsRetention, 
                                            value.name = "Participation", 
                                            varnames = c("Date", "Buildings"))

newRSNet1718AprBuildingsBlock <- reshape2::melt(rsNet1718AprBuildingsBlock, 
                                            value.name = "Participation", 
                                            varnames = c("Date", "Buildings"))

newRSNet1718AprBuildingsGeneral <- reshape2::melt(rsNet1718AprBuildingsGeneral, 
                                            value.name = "Participation", 
                                            varnames = c("Date", "Buildings"))

newRSNet1718AprBuildingsOpen <- reshape2::melt(rsNet1718AprBuildingsOpen, 
                                            value.name = "Participation", 
                                            varnames = c("Date", "Buildings"))

newRSNet1718AprBuildingsDates = as.character(as.Date(newRSNet1718AprBuildings$Dates, 
                                                     format = "%m/%d/%Y"))
substr(newRSNet1718AprBuildingsDates, 1, 2) = "20"
newRSNet1718AprBuildings$Dates = as.Date(newRSNet1718AprBuildingsDates)

newRSNet1718AprBuildingsRetentionDates = as.character(as.Date(newRSNet1718AprBuildingsRetention$Dates, 
                                                     format = "%m/%d/%Y"))
substr(newRSNet1718AprBuildingsRetentionDates, 1, 2) = "20"
newRSNet1718AprBuildingsRetention$Dates = as.Date(newRSNet1718AprBuildingsRetentionDates)

newRSNet1718AprBuildingsBlockDates = as.character(as.Date(newRSNet1718AprBuildingsBlock$Dates, 
                                                     format = "%m/%d/%Y"))
substr(newRSNet1718AprBuildingsBlockDates, 1, 2) = "20"
newRSNet1718AprBuildingsBlock$Dates = as.Date(newRSNet1718AprBuildingsBlockDates)

newRSNet1718AprBuildingsGeneralDates = as.character(as.Date(newRSNet1718AprBuildingsGeneral$Dates, 
                                                     format = "%m/%d/%Y"))
substr(newRSNet1718AprBuildingsGeneralDates, 1, 2) = "20"
newRSNet1718AprBuildingsGeneral$Dates = as.Date(newRSNet1718AprBuildingsGeneralDates)

newRSNet1718AprBuildingsOpenDates = as.character(as.Date(newRSNet1718AprBuildingsOpen$Dates, 
                                                     format = "%m/%d/%Y"))
substr(newRSNet1718AprBuildingsOpenDates, 1, 2) = "20"
newRSNet1718AprBuildingsOpen$Dates = as.Date(newRSNet1718AprBuildingsOpenDates)
```

```{r}
# Descriptive Stats
colSums(rsNet1718AprBuildings[,-1])
colSums(rsNet1718AprBuildingsRetention[,-1])
colSums(rsNet1718AprBuildingsBlock[,-1])
colSums(rsNet1718AprBuildingsGeneral[,-1])
colSums(rsNet1718AprBuildingsOpen[,-1])
```


```{r}
# rsNet1718 by buildings
ggplot(newRSNet1718AprBuildings,aes(x = Dates, y = Participation, group = variable, 
                                    colour = variable)) + geom_line()

# rsNet1718 by buildings during Retention
retain4 <- ggplot(newRSNet1718AprBuildingsRetention,aes(x = Dates, 
                                                        y = Participation, 
                                                        group = variable, 
                                                        colour = variable)) + 
                  geom_line() +
                  theme(legend.position="none")

# rsNet1718 by buildings during Block
block4 <- ggplot(newRSNet1718AprBuildingsBlock,aes(x = Dates, y = Participation, 
                                                   group = variable, 
                                                   colour = variable)) + 
                  geom_line() +
                  theme(legend.position="none")

# rsNet1718 by buildings during General Selection
general4 <- ggplot(newRSNet1718AprBuildingsGeneral,aes(x = Dates, y = Participation, 
                                                       group = variable, 
                                                       colour = variable)) + 
                    geom_line() +
                    theme(legend.position="none")

# rsNet1718 by buildings during Open Assignment
open4 <- ggplot(newRSNet1718AprBuildingsOpen,aes(x = Dates, y = Participation, 
                                                 group = variable, 
                                                 colour = variable)) + 
                geom_line()

grid.arrange(retain4, block4, general4, open4, ncol = 2)
```

#### 2017-18 Vacancies
```{r, echo=FALSE, warning=FALSE, message=FALSE}
# create new columns of aggregated data by building/room type
vacancies1718ByHousesApr_copy$Apartment <-vacancies1718ByHousesApr_copy$DOH +
                                          vacancies1718ByHousesApr_copy$MMA +
                                          vacancies1718ByHousesApr_copy$CLY +
                                          vacancies1718ByHousesApr_copy$FAX +
                                          vacancies1718ByHousesApr_copy$HIGH +
                                          vacancies1718ByHousesApr_copy$NEV +
                                          vacancies1718ByHousesApr_copy$SHA +
                                          vacancies1718ByHousesApr_copy$WEB +
                                          vacancies1718ByHousesApr_copy$ROSE +
                                          vacancies1718ByHousesApr_copy$SP +
                                          vacancies1718ByHousesApr_copy$WOOD
vacancies1718ByHousesApr_copy$Residence_Hall <- vacancies1718ByHousesApr_copy$HEN +
                                                vacancies1718ByHousesApr_copy$MCG +
                                                vacancies1718ByHousesApr_copy$MG +
                                                vacancies1718ByHousesApr_copy$RES +
                                                vacancies1718ByHousesApr_copy$WEL +
                                                vacancies1718ByHousesApr_copy$WW
# vacancies1718 by building/room types
vacancies1718AprBuildings <- vacancies1718ByHousesApr_copy[,-c(2:21)]
vacancies1718AprBuildingsRetention <- vacancies1718AprBuildings[1:2,]
vacancies1718AprBuildingsBlock <- vacancies1718AprBuildings[3:5,]
vacancies1718AprBuildingsGeneral <- vacancies1718AprBuildings[6:15,]
vacancies1718AprBuildingsOpen <- vacancies1718AprBuildings[16:18,]

newVacancies1718AprBuildings <- reshape2::melt(vacancies1718AprBuildings, 
                                           value.name = "Participation", 
                                           varnames = c("Date", "Buildings"))

newVacancies1718AprBuildingsRetention <- reshape2::melt(vacancies1718AprBuildingsRetention, 
                                           value.name = "Participation", 
                                           varnames = c("Date", "Buildings"))

newVacancies1718AprBuildingsBlock <- reshape2::melt(vacancies1718AprBuildingsBlock, 
                                           value.name = "Participation", 
                                           varnames = c("Date", "Buildings"))

newVacancies1718AprBuildingsGeneral <- reshape2::melt(vacancies1718AprBuildingsGeneral, 
                                           value.name = "Participation", 
                                           varnames = c("Date", "Buildings"))

newVacancies1718AprBuildingsOpen <- reshape2::melt(vacancies1718AprBuildingsOpen, 
                                           value.name = "Participation", 
                                           varnames = c("Date", "Buildings"))

newVacancies1718AprBuildingsDates = as.character(as.Date(newVacancies1718AprBuildings$Dates, 
                                                         format = "%m/%d/%Y"))
substr(newVacancies1718AprBuildingsDates, 1, 2) = "20"
newVacancies1718AprBuildings$Dates = as.Date(newVacancies1718AprBuildingsDates)

newVacancies1718AprBuildingsRetentionDates = as.character(as.Date(newVacancies1718AprBuildingsRetention$Dates, 
                                                         format = "%m/%d/%Y"))
substr(newVacancies1718AprBuildingsRetentionDates, 1, 2) = "20"
newVacancies1718AprBuildingsRetention$Dates = as.Date(newVacancies1718AprBuildingsRetentionDates)

newVacancies1718AprBuildingsBlockDates = as.character(as.Date(newVacancies1718AprBuildingsBlock$Dates, 
                                                         format = "%m/%d/%Y"))
substr(newVacancies1718AprBuildingsBlockDates, 1, 2) = "20"
newVacancies1718AprBuildingsBlock$Dates = as.Date(newVacancies1718AprBuildingsBlockDates)

newVacancies1718AprBuildingsGeneralDates = as.character(as.Date(newVacancies1718AprBuildingsGeneral$Dates, 
                                                         format = "%m/%d/%Y"))
substr(newVacancies1718AprBuildingsGeneralDates, 1, 2) = "20"
newVacancies1718AprBuildingsGeneral$Dates = as.Date(newVacancies1718AprBuildingsGeneralDates)

newVacancies1718AprBuildingsOpenDates = as.character(as.Date(newVacancies1718AprBuildingsOpen$Dates, 
                                                         format = "%m/%d/%Y"))
substr(newVacancies1718AprBuildingsOpenDates, 1, 2) = "20"
newVacancies1718AprBuildingsOpen$Dates = as.Date(newVacancies1718AprBuildingsOpenDates)
```

```{r}
# vacancies1718 by buildings
ggplot(newVacancies1718AprBuildings,aes(x = Dates, y = Participation, 
                                        group = variable, colour = variable)) + 
  geom_line()

# vacancies1718 by buildings during Retention
retain5 <- ggplot(newVacancies1718AprBuildingsRetention,aes(x = Dates, y = Participation, 
                                        group = variable, colour = variable)) + 
  geom_line() +
  theme(legend.position="none")

# vacancies1718 by buildings during Block
block5 <- ggplot(newVacancies1718AprBuildingsBlock,aes(x = Dates, y = Participation, 
                                        group = variable, colour = variable)) + 
  geom_line() +
  theme(legend.position="none")

# vacancies1718 by buildings during General Selection
general5 <- ggplot(newVacancies1718AprBuildingsGeneral,aes(x = Dates, y = Participation, 
                                        group = variable, colour = variable)) + 
  geom_line() +
  theme(legend.position="none")

# vacancies1718 by buildings during Open Assignment
open5 <- ggplot(newVacancies1718AprBuildingsOpen,aes(x = Dates, y = Participation, 
                                        group = variable, colour = variable)) + 
  geom_line()

grid.arrange(retain5, block5, general5, open5, ncol = 2)
```

#### 2018-19 Room Selection
```{r, echo=FALSE, warning=FALSE, message=FALSE}
# create new columns of aggregated data by building/room type
occupancy1819ByHouses_copy$Apartment <- occupancy1819ByHouses_copy$DOH +
                                        occupancy1819ByHouses_copy$MMA +
                                        occupancy1819ByHouses_copy$CLY +
                                        occupancy1819ByHouses_copy$FAX +
                                        occupancy1819ByHouses_copy$HIGH +
                                        occupancy1819ByHouses_copy$NEV +
                                        occupancy1819ByHouses_copy$SHA +
                                        occupancy1819ByHouses_copy$WEB +
                                        occupancy1819ByHouses_copy$ROSE +
                                        occupancy1819ByHouses_copy$SP +
                                        occupancy1819ByHouses_copy$WOOD
occupancy1819ByHouses_copy$Residence_Hall <-occupancy1819ByHouses_copy$HEN +
                                            occupancy1819ByHouses_copy$MCG +
                                            occupancy1819ByHouses_copy$MG +
                                            occupancy1819ByHouses_copy$RES +
                                            occupancy1819ByHouses_copy$WEL +
                                            occupancy1819ByHouses_copy$WW
# occupancy1819 by building/room types
occupancy1819Buildings <- occupancy1819ByHouses_copy[,-c(2:21)]
occupancy1819BuildingsRetention <- occupancy1819Buildings[1:3,]
occupancy1819BuildingsBlock <- occupancy1819Buildings[4:5,]
occupancy1819BuildingsGeneral <- occupancy1819Buildings[6:12,]
occupancy1819BuildingsOpen <- occupancy1819Buildings[13:15,]

newOccupancy1819Buildings <- reshape2::melt(occupancy1819Buildings, 
                                                value.name = "Participation", 
                                                varnames = c("Date", "Buildings"))

newOccupancy1819BuildingsRetention <- reshape2::melt(occupancy1819BuildingsRetention, 
                                                value.name = "Participation", 
                                                varnames = c("Date", "Buildings"))

newOccupancy1819BuildingsBlock <- reshape2::melt(occupancy1819BuildingsBlock, 
                                                value.name = "Participation", 
                                                varnames = c("Date", "Buildings"))

newOccupancy1819BuildingsGeneral <- reshape2::melt(occupancy1819BuildingsGeneral, 
                                                value.name = "Participation", 
                                                varnames = c("Date", "Buildings"))

newOccupancy1819BuildingsOpen <- reshape2::melt(occupancy1819BuildingsOpen, 
                                                value.name = "Participation", 
                                                varnames = c("Date", "Buildings"))

newOccupancy1819BuildingsDates = as.character(as.Date(newOccupancy1819Buildings$Dates, 
                                                      format = "%m/%d/%Y"))
substr(newOccupancy1819BuildingsDates, 1, 2) = "20"
newOccupancy1819Buildings$Dates = as.Date(newOccupancy1819BuildingsDates)

newOccupancy1819BuildingsRetentionDates = as.character(as.Date(newOccupancy1819BuildingsRetention$Dates, 
                                                      format = "%m/%d/%Y"))
substr(newOccupancy1819BuildingsRetentionDates, 1, 2) = "20"
newOccupancy1819BuildingsRetention$Dates = as.Date(newOccupancy1819BuildingsRetentionDates)

newOccupancy1819BuildingsBlockDates = as.character(as.Date(newOccupancy1819BuildingsBlock$Dates, 
                                                      format = "%m/%d/%Y"))
substr(newOccupancy1819BuildingsBlockDates, 1, 2) = "20"
newOccupancy1819BuildingsBlock$Dates = as.Date(newOccupancy1819BuildingsBlockDates)

newOccupancy1819BuildingsGeneralDates = as.character(as.Date(newOccupancy1819BuildingsGeneral$Dates, 
                                                      format = "%m/%d/%Y"))
substr(newOccupancy1819BuildingsGeneralDates, 1, 2) = "20"
newOccupancy1819BuildingsGeneral$Dates = as.Date(newOccupancy1819BuildingsGeneralDates)

newOccupancy1819BuildingsOpenDates = as.character(as.Date(newOccupancy1819BuildingsOpen$Dates, 
                                                      format = "%m/%d/%Y"))
substr(newOccupancy1819BuildingsOpenDates, 1, 2) = "20"
newOccupancy1819BuildingsOpen$Dates = as.Date(newOccupancy1819BuildingsOpenDates)
```

```{r}
# occupancy1819 by buildings
ggplot(newOccupancy1819Buildings,aes(x = Dates, y = Participation, group = variable, 
                                     colour = variable)) + geom_line()

# occupancy1819 by buildings during Retention
retain6 <- ggplot(newOccupancy1819BuildingsRetention,aes(x = Dates, y = Participation, 
                                                         group = variable, 
                                                         colour = variable)) + 
                  geom_line() +
                  theme(legend.position="none")

# occupancy1819 by buildings during Block
block6 <- ggplot(newOccupancy1819BuildingsBlock,aes(x = Dates, y = Participation, 
                                                    group = variable, 
                                                    colour = variable)) + 
                  geom_line() +
                  theme(legend.position="none")

# occupancy1819 by buildings during General Selection
general6 <- ggplot(newOccupancy1819BuildingsGeneral,aes(x = Dates, y = Participation, 
                                                        group = variable, 
                                                        colour = variable)) + 
                  geom_line() +
                  theme(legend.position="none")

# occupancy1819 by buildings during Open Assignment
open6 <- ggplot(newOccupancy1819BuildingsOpen,aes(x = Dates, y = Participation, 
                                                  group = variable, 
                                                  colour = variable)) + 
  geom_line()

grid.arrange(retain6, block6, general6, open6, ncol = 2)
```

### 2018 Survey Data Analysis

```{r, echo=FALSE, warning=FALSE, message=FALSE}
surveyResults.copy <- surveyResults

surveyResults.copy <- surveyResults.copy %>%
  mutate(RoomSelection = ifelse(RoomSelection == "No",0,1))

colnames(surveyResults.copy)[3] = "Simplicity"
colnames(surveyResults.copy)[4] = "Fairness"
colnames(surveyResults.copy)[5] = "Stressfulness"
colnames(surveyResults.copy)[6] = "Satisfaction*" # satisfaction with the choices and 
                                                  # desirability of one's final
                                                  # assignment 
colnames(surveyResults.copy)[8] = "Phase"
colnames(surveyResults.copy)[12] = "blockSatisfaction"
colnames(surveyResults.copy)[13] = "blockAsPrioritySelection"

surveyResults.copy <- mutate(surveyResults.copy,
                             Phase = fct_recode(Phase,
                                  "Block" = "Block Housing",
                                  "General" = "General Room Selection/Extended Selection",
                                  "Open" = "Open Assignments",
                                  "Retention" = "Retention/Pull-In"))
surveyResults.copy <- mutate(surveyResults.copy, Phase = fct_lump(Phase, n = 4))
surveyResults.copy <- replace_with_na(surveyResults.copy, replace = list(Phase = "Other"))
surveyResults.copy <- surveyResults.copy[complete.cases(surveyResults.copy[ , 8]),]

surveyResults.copy <- replace_with_na(surveyResults.copy, replace = list(Phase = "Senior"))
surveyResults.copy <- surveyResults.copy[complete.cases(surveyResults.copy[ , 1]),]

surveyResults.copy <- replace_with_na(surveyResults.copy, 
                                      replace = list(blockAsPrioritySelection = ""))

```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
Year_ordered <- ordered(surveyResults.copy$Year, levels = c("First-Year", "Sophomore", "Junior", "Senior"))

Phase_ordered <- ordered(surveyResults.copy$Phase, levels = c("Retention", "Block", "General", "Open"))

# Distribution of class years
ggplot(data = surveyResults.copy, aes(x = Year_ordered, 
                                      na.rm = TRUE)) + 
      geom_bar() +
      labs(x = "Class", y = "Count", title = "Distribution of Class")

# Distribution of phases
ggplot(data = surveyResults.copy, aes(x = Phase_ordered)) + 
  geom_bar() +
  labs(title = "Distribution of Participation in Room Selection Phases",
       x = "Phase of Room Selection",
       y = "Count", title = "Distribution of Phases")

# Year vs Phase of Room Selection participating in
ggplot(data = surveyResults.copy, aes(x = Year_ordered,
                                      fill = Phase_ordered,
                                      na.rm = TRUE)) + 
      geom_bar() +
      labs(x = "Class", y = "Count", fill = "Phase of Room Selection",
           title = "Class by Phase")

ggplot(data = surveyResults.copy, aes(x = Phase_ordered,
                                      fill = Year_ordered,
                                      na.rm = TRUE)) + 
      geom_bar() +
      labs(x = "Phase of Room Selection", y = "Count", fill = "Class",
           title = "Phase by Class")

# Distribution of fairness
ggplot(data = surveyResults.copy, aes(x = surveyResults.copy$Fairness,
                                      na.rm = TRUE)) + 
      geom_bar() +
      labs(x = "Fairness (1=least; 5=most)", y = "Count",
           title = "Distribution of Fairness")

# Year vs Perception of fairness
ggplot(data = surveyResults.copy, aes(x = surveyResults.copy$Fairness,
                                      fill = Year_ordered,
                                      na.rm = TRUE)) + 
      geom_bar() +
      labs(x = "Fairness (1=least; 5=most)", y = "Count", fill = "Class",
           title = "Perception of fairness by Class")

# Year vs Perception of Simplicity
ggplot(data = surveyResults.copy, aes(x = surveyResults.copy$Simplicity,
                                      fill = Year_ordered,
                                      na.rm = TRUE)) + 
      geom_bar() +
      labs(x = "Simplicity (1=least; 5=most)", y = "Count", fill = "Class",
           title = "Perception of simplicity by Class")

# Year vs Perception of Stressfulness
ggplot(data = surveyResults.copy, aes(x = surveyResults.copy$Stressfulness,
                                      fill = Year_ordered,
                                      na.rm = TRUE)) + 
      geom_bar() +
      labs(x = "Stressfulness (1=least; 5=most)", y = "Count", fill = "Class",
           title = "Perception of stressfulness by Class")

# Phase vs Fairness
ggplot(data = surveyResults.copy, aes(x = surveyResults.copy$Fairness,
                                      fill = Phase_ordered,
                                      na.rm = TRUE)) + 
      geom_bar() +
      labs(x = "Fairness (1=least; 5=most)", y = "Count", 
           fill = "Phase of Room Selection", 
           title = "Perception of fairness by Phase")

# Phase vs Simplicity
ggplot(data = surveyResults.copy, aes(x = surveyResults.copy$Simplicity,
                                      fill = Phase_ordered,
                                      na.rm = TRUE)) + 
      geom_bar() +
      labs(x = "Simplicity (1=least; 5=most)", y = "Count", 
           fill = "Phase of Room Selection",
           title = "Perception of simplicity by Phase")

# Phase vs Stressfulness
ggplot(data = surveyResults.copy, aes(x = surveyResults.copy$Stressfulness,
                                      fill = Phase_ordered,
                                      na.rm = TRUE)) + 
      geom_bar() +
      labs(x = "Stressfulness (1=least; 5=most)", y = "Count", fill = "Class",
           title = "Perception of stressfulness by Phase")

# satisfaction with choices/preferences/final assignment
# raw satisfaction graph

# can be used to help provide insight into 'pareto efficiency'
ggplot(data = surveyResults.copy, aes(x = surveyResults.copy$`Satisfaction*`,
                                      na.rm = TRUE)) +
      geom_bar() +
      labs(caption = "Satisfaction a general term to indicate a participant's opinion, 
           on the desirability of the choices available to them as well as their final, 
           assignments", 
           x = "Satisfaction (1=least; 5=most)", 
           y = "Count",
           title = "Distribution of satisfaction with final assignments")

# satisfaction with Block Assignment
ggplot(data = surveyResults.copy, aes(x = surveyResults.copy$blockSatisfaction),
                                      na.rm = TRUE) + 
  geom_bar() +
  labs(title = "Distribution of Satisfaction with Block Assignments",
       caption = "subset of those participating in block housing, sample < 300",
       x = "Satisfaction (1=least; 5=most)",
       y = "Count")

# block Housing as priority selection
surveyResults.copy %>% 
        drop_na(blockAsPrioritySelection) %>%
        ggplot(aes(x = blockAsPrioritySelection)) + geom_bar() +
                   labs(title = "Perception of Block Housing as Priority Selection",
                        caption = "Actual wording of question: 'Would one still do block',
                                  'if block were after General Selection?'",
                        x = "",
                        y = "Count")


```

```{r}
byClass <- read.csv("~/Desktop/thesisDocuments/rsParticipationByClass.csv")
byClass <- byClass[1:5,]

byClass$participation2016 <- byClass$participated2016 / byClass$eligible2016
byClass$participation2017 <- byClass$participated2017 / byClass$eligible2017

colnames(byClass) <- c("Year", "eligible2016", "participated2016", 
                       "eligible2017", "participated2017", "participation2016",
                       "participation2017")

newByClass <- reshape2::melt(byClass, value.name = "classParticipationRS", 
                             varnames = c("Class", "participation"))

newClassParticipationCount <- newByClass[c(6:9,16:19),]
newClassParticipationProportion <- newByClass[c(21:24,26:29),]

Year_ordered <- ordered(newClassParticipationCount$Year, levels = c("First-Year", "Sophomore", "Junior", "Senior"))

ggplot(newClassParticipationCount,aes(x = variable, y = classParticipationRS)) +
                  geom_bar(aes(fill = Year_ordered), stat = "identity", 
                           position = "dodge") +
                  labs(title = "Room Selection Participation by class for 2017 and 2018",
                        x = "Year", y = "Count",
                       fill = "Class")

ggplot(newClassParticipationProportion,aes(x = variable, y = classParticipationRS)) +
                  geom_bar(aes(fill = Year_ordered), stat = "identity", 
                           position = "dodge") +
                  labs(title = "Room Selection Participation by class by proportion \nto each individual class for 2017 and 2018",
                       x = "Year", y = "Proportion",
                       fill = "Class")

ggplot(newClassParticipationCount,aes(x = variable, y = classParticipationRS)) +
                  geom_bar(aes(fill = Year_ordered), stat = "identity", 
                           position = "fill") +
                  labs(title = "Room Selection Participation by class by proportion \nto total participants for 2017 and 2018",
                       x = "Year", y = "Proportion",
                       fill = "Class")
```

